<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% if page.title %}{{ page.title | escape }} - {{ site.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
  <meta name="description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">

  <!-- favicon -->
  <link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg" />
  <link rel="shortcut icon" href="/assets/images/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Lindsey B" />
  <link rel="manifest" href="/assets/images/site.webmanifest" />
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="{% if page.layout == 'post' %}article{% else %}website{% endif %}">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  <meta property="og:title" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}">
  <meta property="og:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
  <meta property="og:image" content="{{ site.logo | absolute_url }}">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{{ page.url | absolute_url }}">
  <meta property="twitter:title" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}">
  <meta property="twitter:description" content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description }}{% endif %}">
  <meta property="twitter:image" content="{{ site.logo | absolute_url }}">

  <link rel="canonical" href="{{ page.url | absolute_url }}">
  <link rel="icon" type="image/png" href="{{ site.logo | absolute_url }}">

  <!-- CSS -->
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Theme Detection Script -->
  <script>
    // Detect user's system preference and saved preference
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
    document.documentElement.setAttribute('data-theme', theme);
  </script>
</head>

<body>
  <div class="site-wrapper">
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
      <span id="theme-icon">üåô</span>
    </button>

    <!-- Site Header -->
    <header class="site-header">
      <nav class="site-nav">
        <a href="{{ '/' | relative_url }}" class="site-title">{{ site.title }}</a>

        <ul class="nav-links">
          <li><a href="{{ '/' | relative_url }}" class="nav-link">Home</a></li>
          <li><a href="{{ '/projects' | relative_url }}" class="nav-link">Projects</a></li>
          <li><a href="{{ '/archive' | relative_url }}" class="nav-link">Archive</a></li>
          <li><a href="{{ '/about' | relative_url }}" class="nav-link">About</a></li>
          <li><a href="https://lindseyb.github.io/resume/" class="nav-link" target="_blank" rel="noopener noreferrer">Resume</a></li>
        </ul>
      </nav>
    </header>

    <!-- Main Content -->
    <main class="site-main">
      {{ content }}
    </main>

    <!-- Site Footer -->
    <footer class="site-footer">
      <div class="footer-content">
        {% if site.footer.links %}
        <div class="footer-links">
          {% for link in site.footer.links %}
          <a href="{{ link.url }}" class="footer-link" target="_blank" rel="noopener noreferrer">
            {{ link.label }}
          </a>
          {% endfor %}
        </div>
        {% endif %}

        <div class="footer-copyright">
          <p>&copy; {{ 'now' | date: "%Y" }} {{ site.title }}. Powered by Jekyll.</p>
        </div>

        <div class="footer-moth-container">
          <img src="{{ '/assets/images/lunamoth.png' | relative_url }}" alt="Luna Moth" class="footer-moth">
        </div>
      </div>
    </footer>
  </div>

  <!-- Theme Toggle Script -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const themeToggle = document.getElementById('theme-toggle');
      const themeIcon = document.getElementById('theme-icon');
      const html = document.documentElement;

      // Update icon based on current theme
      function updateThemeIcon() {
        const currentTheme = html.getAttribute('data-theme');
        themeIcon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      }

      // Initialize icon
      updateThemeIcon();

      // Theme toggle handler
      themeToggle.addEventListener('click', function() {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateThemeIcon();
      });

      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
          const newTheme = e.matches ? 'dark' : 'light';
          html.setAttribute('data-theme', newTheme);
          updateThemeIcon();
        }
      });
    });
  </script>
</body>
</html>
